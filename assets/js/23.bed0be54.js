(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{454:function(t,a,e){"use strict";e.r(a);var r=e(16),_=Object(r.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"_1-etcd是什么"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-etcd是什么"}},[t._v("#")]),t._v(" "),e("strong",[t._v("1. etcd是什么")])]),t._v(" "),e("p",[t._v("etcd是一个分布式的、高可用的、一致的key-value存储数据库，基于Go语言实现，主要用于共享配置和服务发现（也可以实现分布式锁）。类似于zookeeper。其特点为：")]),t._v(" "),e("ul",[e("li",[t._v("完全复制：集群中的每个节点都可以使用完整的存档")]),t._v(" "),e("li",[t._v("高可用性：Etcd可用于避免硬件的单点故障或网络问题")]),t._v(" "),e("li",[t._v("一致性：每次读取都会返回跨多主机的最新写入")]),t._v(" "),e("li",[t._v("简单：包括一个定义良好、面向用户的API（gRPC）")]),t._v(" "),e("li",[t._v("安全：实现了带有可选的客户端证书身份验证的自动化TLS")]),t._v(" "),e("li",[t._v("快速：每秒10000次写入的基准速度")]),t._v(" "),e("li",[t._v("可靠：使用Raft算法实现了强一致、高可用的服务存储目录")])]),t._v(" "),e("h2",{attrs:{id:"_2-为什么需要etcd"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-为什么需要etcd"}},[t._v("#")]),t._v(" 2. 为什么需要etcd")]),t._v(" "),e("p",[t._v("在分布式系统中，各种服务配置信息的管理、共享和服务发现是一个基本且重要的问题。etcd可集中管理配置信息，服务端将配置信息存储于etcd，客户端通过etcd得到服务配置信息，etcd监听配置信息的改变，发现改变通知客户端。")]),t._v(" "),e("p",[t._v("为了防止单点故障，还可启动多个etcd组成集群。etcd集群使用raft一致性算法处理日志复制，保证多节点数据的强一致性。")]),t._v(" "),e("h2",{attrs:{id:"_3-etcd的raft算法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-etcd的raft算法"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3. etcd的raft算法")])]),t._v(" "),e("h3",{attrs:{id:"_3-1-主节点选举"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-主节点选举"}},[t._v("#")]),t._v(" 3.1 主节点选举")]),t._v(" "),e("p",[t._v("etcd集群中有一个主节点（leader，负责写操作），多个从节点（follower，负责读操作）。")]),t._v(" "),e("p",[t._v("主节点会发送心跳包给从节点，从节点进行响应。从节点若超过一定时间（一定范围内的随机值）没有收到主节点的心跳包，则认为主节点已不可用，自身可成为候选主节点（candidate），发起投票，若超过一半节点响应，则可成为新的主节点（可能会有几轮争夺）。在每一轮投票中，参与投票的所有节点，只响应收到的第一个投票请求，对后续请求不作响应。")]),t._v(" "),e("h3",{attrs:{id:"_3-2-数据更新"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-数据更新"}},[t._v("#")]),t._v(" 3.2 数据更新")]),t._v(" "),e("ul",[e("li",[t._v("第一阶段：主节点将修改记录到本地日志，并将日志复制给所有从节点，若超过一半节点响应，则认为操作成功，通知客户端。")]),t._v(" "),e("li",[t._v("第二阶段：主节点提交本地修改（持久化到磁盘），通知所有从节点也进行数据修改提交。")])]),t._v(" "),e("h2",{attrs:{id:"_4-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装"}},[t._v("#")]),t._v(" 4. 安装")]),t._v(" "),e("h3",{attrs:{id:"_4-1-下载etcd"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-下载etcd"}},[t._v("#")]),t._v(" 4.1 下载etcd")]),t._v(" "),e("p",[t._v("https://github.com/etcd-io/etcd/releases")]),t._v(" "),e("h3",{attrs:{id:"_4-2-安装etcd"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-安装etcd"}},[t._v("#")]),t._v(" 4.2 安装etcd")]),t._v(" "),e("p",[t._v("解压文件，添加可执行文件路径到环境变量PATH中。")]),t._v(" "),e("p",[e("strong",[t._v("安装目录下etcd.exe是服务端，etcdctl.exe是客户端")])]),t._v(" "),e("h3",{attrs:{id:"_4-3-下载并安装etcd-manager-etcd的可视化客户端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-下载并安装etcd-manager-etcd的可视化客户端"}},[t._v("#")]),t._v(" 4.3 下载并安装etcd-manager（etcd的可视化客户端）")]),t._v(" "),e("p",[t._v("https://etcdmanager.io/")]),t._v(" "),e("h2",{attrs:{id:"_5-简单操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-简单操作"}},[t._v("#")]),t._v(" 5. 简单操作")]),t._v(" "),e("h3",{attrs:{id:"_5-1-启动etcd"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-启动etcd"}},[t._v("#")]),t._v(" 5.1 启动etcd")]),t._v(" "),e("p",[t._v("![image-20211011170247621](C:\\Users\\Scott Ma\\AppData\\Roaming\\Typora\\typora-user-images\\image-20211011170247621.png)")]),t._v(" "),e("p",[t._v("默认端口为2379。进入etcd安装目录，etcdctl客户端可用于请求etcd。")]),t._v(" "),e("h3",{attrs:{id:"_5-2-查询版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-查询版本"}},[t._v("#")]),t._v(" 5.2 查询版本")]),t._v(" "),e("p",[t._v("etcdctl的API版本为2或3，默认为2，因此我们需要设置环境变量ETCDCTL_API=3。")]),t._v(" "),e("p",[t._v("![image-20211011170507136](C:\\Users\\Scott Ma\\AppData\\Roaming\\Typora\\typora-user-images\\image-20211011170507136.png)")]),t._v(" "),e("h3",{attrs:{id:"_5-3-键值添加与查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-键值添加与查询"}},[t._v("#")]),t._v(" 5.3 键值添加与查询")]),t._v(" "),e("p",[t._v("![image-20211011170445039](C:\\Users\\Scott Ma\\AppData\\Roaming\\Typora\\typora-user-images\\image-20211011170445039.png)")]),t._v(" "),e("h3",{attrs:{id:"_5-4-etcd-manager"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-etcd-manager"}},[t._v("#")]),t._v(" 5.4 ETCD Manager")]),t._v(" "),e("p",[t._v("![image-20211011172325558](C:\\Users\\Scott Ma\\AppData\\Roaming\\Typora\\typora-user-images\\image-20211011172325558.png)")]),t._v(" "),e("h3",{attrs:{id:"巨人的肩膀"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#巨人的肩膀"}},[t._v("#")]),t._v(" 巨人的肩膀：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.cnblogs.com/wujuntian/p/12837926.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("etcd简单介绍"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://blog.csdn.net/qq_44205272/article/details/111394836",target:"_blank",rel:"noopener noreferrer"}},[t._v("etcd"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=_.exports}}]);